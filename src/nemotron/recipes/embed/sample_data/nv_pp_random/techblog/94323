
Risk and uncertainty inherent in energy exploration include unknown geological parameters, variations in fluid and rock properties, boundary conditions, and noisy observational data. Rigorous calibration of uncertainty for key reservoir engineering tasks and field optimization requires running a large number of forward simulations. Use cases range from history matching and probabilistic forecasting to inverse problems. When coupled with high-fidelity models containing hundreds of thousands or millions of active grid cells, high-performance computing (HPC) simulators demand significant computational resources.
Traditionally, proxy or surrogate models are used to address these challenges, as they enable rapid evaluations of scenarios. Many of the existing proxy generation methods address specialized scenarios and cannot be generalized to different problems. A full-field proxy model, on the other hand, directly approximates the solution of primary or state variables of a reservoir both in space and time similar to a full-physics numerical simulator.
Thus, these proxies can be substituted in place of the full simulator and can be used to address a wide variety of challenges. Generation of full-field proxies for a 3D reservoir has remained a challenge due to high computational requirements and algorithmic challenges. However, a promising approach to generate a full field proxy lies in the combination of using the state-of-the-art ML techniques like neural operators, a high performance full-physics reservoir simulator, and modern GPUs with high memory and massive computational power like NVIDIA A100, H100 and H200 GPUs.
Stone Ridge Technology (SRT) has developed a highly scalable framework to generate full-field proxy models by integrating its reservoir simulator ECHELON with NVIDIA PhysicsNeMo on AWS. NVIDIA PhysicsNeMo is an open-source framework for building, training, and fine-tuning physics-ML models for full-field proxy generation with a Python interface. These full-field proxy models are 10x-100x faster than the forward simulations while providing reasonably accurate results compared to a full-physics numerical solution. Such a generalized framework coupling NVIDIA PhysicsNeMo and ECHELON can be used for addressing existing challenges such as uncertainty quantification and many field optimization problems. They can also be used to generate new engineering workflows not possible otherwise.
ECHELON generates large volumes of training and test and validation data needed to build the ML model. The generated data is stored on Amazon S3, a scalable object storage, for fast and easy retrieval purposes. The proxy models can then be used for solution inference orders of magnitude faster than a forward simulation. The schematic of the overall workflow is shown in Figure 1.
A workflow diagram illustrating the machine learning process for proxy generation using the Echelon reservoir simulator and NVIDIA PhysicsNeMo. The workflow consists of five sequential steps: Ensemble generation, Echelon forward modeling, ML data preprocessing, NVIDIA PhysicsNeMo training and validation, and Build proxy.
Figure 1. ML workflow combining reservoir simulator ECHELON with NVIDIA PhysicsNeMo for fast and accurate proxy generation
Neural operator-based proxy generation using NVIDIA PhysicsNeMo
Stone Ridge Technology used a Fourier neural operator (FNO) model for generating the spatio-temporal reservoir proxies with NVIDIA PhysicsNeMo on AWS. A high-level overview of the FNO network is shown in Figure 2. Details of the methodology can be found in Neural Operator: Learning Maps Between Function Spaces and the NVIDIA PhysicsNeMo GitHub repository.
Schematic of Fourier neural operator architecture for full-field prediction. Important steps used in the architecture are illustrated. The input layer (data) is first lifted to a higher dimensional space. A FNO layer and a residual convolution in physical space is applied multiple times to learn the kernel operator. The transformed data is passed through multiple convolutional decoder layers and finally transformed to the output layers. Each sample of the input is finally transformed to an output layer that consists of 0 to N time slices.
Figure 2. Fourier neural operator architecture for generating spatio-temporal reservoir proxies with NVIDIA PhysicsNeMo on AWS
Implementation on AWS Cloud
The reservoir simulation workflow was implemented on AWS, which provides a flexible on-demand compute resource with the ability to handle large amounts of data. An overview of the AWS architecture is provided in Figure 3.
A diagram showing the architecture of SRT ECHELON with NVIDIA PhysicsNeMo on AWS. The corporate data center hosts reservoir engineers and geology applications, connected securely to AWS services. AWS includes Amazon SageMaker for model training and notebooks, AWS Parallel Cluster with EC2 GPU acceleration for simulations, and S3 for storing historical simulations and simulation data.
Figure 3. Architecture of SRT ECHELON with NVIDIA PhysicsNeMo on AWS
Results for neural operator-based proxies
The following examples created by SRT showcase neural operator-based proxies.
Proxy model for well placement optimization
The first example represents a well placement optimization scenario in a reservoir with fixed, but spatially heterogeneous geological properties, such as porosity and permeability. There are four producer wells and one water injector well.
Training samples are generated by varying the positions of injectors and producers, where four random samples for well positions are plotted (Figure 4). In total, 500 samples were used for training, testing and validation.
3D visualization showing random samples of validation data with different well placement scenarios in a reservoir. The reservoir is characterized by high heterogeneity and extreme variations in permeability. Each cube represents a distinct well placement configuration.
Figure 4. Random samples of validation data depicting different well placement scenarios in a reservoir characterized by highly heterogeneous and extreme variations in permeability field
The PhysicsNeMo-based FNO proxy solution for 3D evolution of water saturation is compared to the ground-truth solution of the forward simulator ECHELON. The complex topological details of the waterfront propagation are well captured by FNO. Figure 5 shows the FNO predictions ( PhysicsNeMo ) compared against ground truth ( ECHELON ) for water front propagation for different well placement scenarios in a highly heterogeneous permeability field for different normalized times. The plots on the right show a comparison of field averaged quantities of pressure, water, and oil saturations between FNO and ground-truth simulations.
Comparison of FNO predictions (middle column) and ground truth (left column) for water front propagation at different normalized times (t = 0.1, 0.5, 1) in well placement scenarios with highly heterogeneous permeability fields. The right column displays line plots comparing field-averaged pressure, water saturation, and oil saturation between the FNO predictions and ground truth over normalized time.
Figure 5. PhysicsNeMo-based FNO proxy solution for 3D evolution of water saturation is compared to the ground-truth solution of the forward simulator ECHELON
Proxy model with geological uncertainties
The second example is a real-field model with highly complex geology with faults. The reservoir model chosen for this study is based on a real subsurface model for a production Norne field in the Norwegian Sea. The grid is a faulted corner-point grid, with heterogeneous and anisotropic permeability. The size of the reservoir grid is 46 x 112 x 22. The model consists of 35 wells in total with nine water injectors, four gas injectors and 22 producers (Figure 6).
The 22 producer wells have measurable quantities of oil, gas, and water rates controlled by a fixed bottom-hole-pressure. The nine water injector wells have a measurable quantity of bottom hole pressure (BHP), controlled by fixed injection rates. A total of 3,298 days of simulation are simulated. A full-field proxy is considered in the presence of uncertainties in geological properties such as porosity, permeability and fault transmissibility multipliers, but with fixed well locations.
3D visualization of the Norne field showing the locations of various producer and injector wells. The reservoir is represented with a grid and is characterized by complex fault structures. A color bar indicates reservoir properties, ranging from 0 to 1.
Figure 6. Depiction of Norne field with the location of different producer and injector wells. The reservoir is characterized by complex faults
Training and test data were generated using 500 realizations of the Norne model that include variations in porosity, rock permeabilities, and fault transmissibility multipliers. Figure 7 shows two random samples from the training data depicting the variations in permeability and porosity fields.
3D visualization showing random samples from training data, illustrating variations in permeability and porosity fields. The top row displays permeability (PERMX) with a color scale, and the bottom row shows porosity (PORO) with a different color scale, highlighting heterogeneity in the reservoir properties.
Figure 7. Random samples from training data depicting variations in permeability and porosity fields
Figures 8 and 9 compare time evolution of the solution variables, pressure, and water saturation between the PhysicsNeMo FNO solution and ECHELON for a randomly chosen realization. SRT saw strong agreement in results for both pressure and saturation fields with only small errors in the solutions.
Comparison of pressure evolution predicted by ECHELON (left column) and NVIDIA PhysicsNeMo (middle column) at different normalized times (t = 1, t = 15, t = 25). The right column shows the error between the two models. Color bars indicate pressure values for PhysicsNeMo and ECHELON, and error magnitude.
Figure 8. Comparison of pressure evolution predicted by both NVIDIA PhysicsNeMo and ECHELON at different normalized times along with the error
Comparison of gas saturation evolution predicted by ECHELON (left column) and NVIDIA PhysicsNeMo (middle column) at different normalized times (t = 1, t = 15, t = 25). The right column shows the error between the two models. Color bars indicate gas saturation values for PhysicsNeMo and ECHELON, and error magnitude.
Figure 9. Comparison of gas saturation evolution predicted by both NVIDIA PhysicsNeMo and ECHELON at different normalized times along with the error
Conclusion
Stone Ridge Technology developed a workflow combining its ECHELON reservoir simulator with a NVIDIA PhysicsNeMo. The full-physics simulator serves as both a validator and data generator for the surrogate models developed using the ML framework. The full-field surrogate models are an order-of-magnitude faster than the forward simulations while providing reasonably accurate results paving way for rapid evaluation of scenarios. Such a generalized framework coupling NVIDIA PhysicsNeMo and ECHELON can be used for addressing existing challenges such as uncertainty quantification and many field optimization problems.
This framework provides a promising backbone for important subsurface applications, such as uncertainty quantification and field development optimization, with enhanced performance and high accuracy.
Learn more about building and deploying a generative AI reservoir simulation assistant with Stone Ridge Technology and AWS.
Explore how to accelerate subsurface workloads with AI, high-performance computing (HPC) and visualization.